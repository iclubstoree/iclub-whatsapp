<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>CONTROLE ICLUB SA√çDAS</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --primary-color: #10b981;
      --secondary-color: #059669;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --danger-color: #ef4444;
      --dark-color: #1f2937;
      --light-bg: #f8fafc;
      --white: #ffffff;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --whatsapp-green: #25d366;
      --whatsapp-dark: #128c7e;
      --ai-gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
      --ai-color: #10b981;
    }

    body {
      background: #ffffff;
      min-height: 100vh;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      padding: 0;
    }

    /* ===== LOGIN CONTAINER ===== */
    .login-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .login-box {
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
      max-width: 400px;
      width: 90%;
      text-align: center;
    }

    .login-title {
      color: #10b981;
      font-weight: 800;
      font-size: 1.8rem;
      margin-bottom: 30px;
    }

    .login-form .form-control {
      border-radius: 12px;
      border: 2px solid #e5e7eb;
      padding: 15px;
      margin-bottom: 20px;
      font-size: 1rem;
    }

    .login-form .form-control:focus {
      border-color: #10b981;
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      outline: none;
    }

    .login-btn {
      background: var(--ai-gradient);
      border: none;
      border-radius: 12px;
      padding: 15px 30px;
      color: white;
      font-weight: 700;
      font-size: 1rem;
      width: 100%;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
    }

    .login-error {
      background: #fee2e2;
      border: 2px solid #ef4444;
      color: #dc2626;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }

    .demo-credentials {
      background: #f0f9ff;
      border: 2px solid #0ea5e9;
      border-radius: 12px;
      padding: 15px;
      margin-top: 20px;
      font-size: 0.85rem;
      color: #0c4a6e;
    }

    /* ===== MAIN CONTAINER ===== */
    .main-container {
      background: var(--white);
      border-radius: 20px;
      box-shadow: var(--shadow-lg);
      margin: 20px auto;
      padding: 30px;
      max-width: 1400px;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.5s ease;
      display: none;
    }

    .main-container.show {
      opacity: 1;
      transform: translateY(0);
      display: block;
    }

    .header-title {
      color: #10b981;
      font-weight: 800;
      font-size: 2rem;
      margin-bottom: 30px;
      text-align: center;
      position: relative;
    }

    /* ===== NOTIFICA√á√ÉO INTELIGENTE ===== */
    .notificacao-inteligente {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      padding: 15px 25px;
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
      z-index: 9999;
      transform: translateX(400px);
      opacity: 0;
      transition: all 0.3s ease;
      max-width: 350px;
      font-weight: 600;
    }

    .notificacao-inteligente.show {
      transform: translateX(0);
      opacity: 1;
    }

    .notificacao-inteligente.error {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      box-shadow: 0 8px 25px rgba(239, 68, 68, 0.3);
    }

    .notificacao-inteligente.warning {
      background: linear-gradient(135deg, #f59e0b, #d97706);
      box-shadow: 0 8px 25px rgba(245, 158, 11, 0.3);
    }

    /* ===== DASHBOARD ===== */
    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .dashboard-card {
      background: var(--white);
      border-radius: 16px;
      padding: 25px;
      text-align: center;
      box-shadow: var(--shadow);
      border: none;
      transition: transform 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    .dashboard-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(135deg, var(--success-color), #059669);
    }

    .dashboard-card:hover {
      transform: translateY(-3px);
    }

    .dashboard-value {
      font-size: 1.8rem;
      font-weight: 800;
      color: var(--dark-color);
      margin-bottom: 5px;
    }

    .dashboard-label {
      color: var(--success-color);
      font-weight: 600;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* ===== FORM STYLES ===== */
    .card-modern {
      background: var(--white);
      border-radius: 16px;
      box-shadow: var(--shadow);
      border: none;
      padding: 25px;
      margin-bottom: 25px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .card-modern:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .form-control, .form-select {
      border-radius: 12px;
      border: 2px solid #e5e7eb;
      padding: 12px 16px;
      transition: all 0.2s ease;
      background: var(--light-bg);
    }

    .form-control:focus, .form-select:focus {
      border-color: var(--success-color);
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      background: var(--white);
      outline: none;
    }

    .btn-modern {
      border-radius: 12px;
      padding: 12px 24px;
      font-weight: 600;
      transition: all 0.2s ease;
      border: none;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-size: 0.85rem;
      cursor: pointer;
    }

    .btn-success-modern {
      background: linear-gradient(135deg, var(--success-color), #059669);
      color: white;
    }

    .btn-success-modern:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 15px rgba(16, 185, 129, 0.3);
    }

    .btn-primary-modern {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
    }

    .btn-primary-modern:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 15px rgba(99, 102, 241, 0.3);
    }

    .btn-warning-modern {
      background: linear-gradient(135deg, var(--warning-color), #d97706);
      color: white;
    }

    .btn-warning-modern:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 15px rgba(245, 158, 11, 0.3);
    }

    .btn-danger-modern {
      background: linear-gradient(135deg, var(--danger-color), #dc2626);
      color: white;
    }

    .btn-danger-modern:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 15px rgba(239, 68, 68, 0.3);
    }

    /* ===== TABLE STYLES ===== */
    .table-modern {
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow);
      border: none;
    }

    .table-modern thead {
      background: linear-gradient(135deg, var(--success-color), #059669);
      color: white;
    }

    .table-modern th {
      border: none;
      padding: 16px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-size: 0.85rem;
      text-align: center;
    }

    .table-modern td {
      border: none;
      padding: 16px;
      vertical-align: middle;
      border-bottom: 1px solid #f1f5f9;
      text-align: center;
    }

    .table-modern tbody tr:hover {
      background: var(--light-bg);
      transition: background 0.2s ease;
    }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 768px) {
      .main-container {
        margin: 10px;
        padding: 20px;
        border-radius: 16px;
      }
      
      .dashboard-cards {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
      }
      
      .dashboard-value {
        font-size: 1.4rem;
      }

      .header-title {
        margin-bottom: 10px;
        font-size: 1.5rem;
      }

      .login-box {
        padding: 30px 20px;
      }

      .table-modern {
        font-size: 0.85rem;
      }

      .table-modern th,
      .table-modern td {
        padding: 12px 8px;
      }
    }

    @media (max-width: 480px) {
      .header-title {
        font-size: 1.3rem;
      }

      .dashboard-value {
        font-size: 1.2rem;
      }

      .dashboard-label {
        font-size: 0.8rem;
      }

      .table-modern th,
      .table-modern td {
        padding: 8px 4px;
        font-size: 0.75rem;
      }

      .btn-modern {
        padding: 6px 12px;
        font-size: 0.75rem;
      }

      .form-control,
      .form-select {
        padding: 10px 12px;
        font-size: 0.9rem;
      }
    }

    /* ===== LOADING ===== */
    .loading {
      display: none;
      text-align: center;
      padding: 20px;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid var(--success-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- LOGIN CONTAINER -->
  <div id="loginContainer" class="login-container">
    <div class="login-box">
      <h2 class="login-title">
        <i class="fas fa-chart-line"></i><br>
        iClub Sa√≠das
      </h2>
      <div id="loginError" class="login-error">
        <i class="fas fa-exclamation-circle"></i>
        <span id="loginErrorText">Usu√°rio ou senha incorretos!</span>
      </div>
      <form class="login-form" id="loginForm">
        <input type="text" id="loginUsuario" class="form-control" placeholder="Usu√°rio" required autocomplete="username">
        <input type="password" id="loginSenha" class="form-control" placeholder="Senha" required autocomplete="current-password">
        <button type="submit" class="login-btn" id="loginButton">
          <i class="fas fa-sign-in-alt"></i> Entrar
        </button>
      </form>
      <div class="demo-credentials">
        <strong>üë§ Credenciais Demo:</strong><br>
        <small>
          <strong>Admin:</strong> admin / admin123<br>
          <strong>Usu√°rio 1:</strong> user1 / user123<br>
          <strong>Usu√°rio 2:</strong> user2 / user456
        </small>
      </div>
    </div>
  </div>

  <!-- NOTIFICA√á√ÉO INTELIGENTE -->
  <div id="notificacaoInteligente" class="notificacao-inteligente">
    <span id="textoNotificacao"></span>
  </div>

  <!-- MAIN CONTAINER -->
  <div id="mainContainer" class="main-container">
    <h1 class="header-title">
      <span style="margin-right: 15px; font-size: 2.5rem;">üìä</span>
      <span>CONTROLE ICLUB SA√çDAS</span>
    </h1>

    <!-- DASHBOARD -->
    <div class="dashboard-cards">
      <div class="dashboard-card">
        <div class="dashboard-value" id="totalMes">R$ 0,00</div>
        <div class="dashboard-label">Total do M√™s</div>
      </div>
      <div class="dashboard-card">
        <div class="dashboard-value" id="totalRecorrente">R$ 0,00</div>
        <div class="dashboard-label">Recorrente</div>
      </div>
      <div class="dashboard-card">
        <div class="dashboard-value" id="maiorGasto">R$ 0,00</div>
        <div class="dashboard-label">Maior Gasto</div>
      </div>
      <div class="dashboard-card">
        <div class="dashboard-value" id="categoriaTopo">-</div>
        <div class="dashboard-label">Categoria Top</div>
      </div>
      <div class="dashboard-card">
        <div class="dashboard-value" id="totalSaidas">0</div>
        <div class="dashboard-label">Total Sa√≠das</div>
      </div>
    </div>

    <!-- FORMUL√ÅRIO ADICIONAR SA√çDA -->
    <div class="card-modern">
      <h5 class="mb-3">‚ûï Adicionar Sa√≠da</h5>
      <div class="row g-3">
        <div class="col-md-3">
          <label class="form-label fw-bold">Loja:</label>
          <select id="loja" class="form-select">
            <option>Loja Centro</option>
            <option>Loja Shopping</option>
            <option>Loja Bairro</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label fw-bold">Centro de Custo:</label>
          <select id="categoria" class="form-select">
            <option>Aluguel</option>
            <option>Energia</option>
            <option>Internet</option>
            <option>Combust√≠vel</option>
            <option>Material</option>
            <option>Transporte</option>
            <option>Alimenta√ß√£o</option>
            <option>Marketing</option>
            <option>Sa√∫de</option>
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label fw-bold">Descri√ß√£o:</label>
          <input type="text" id="descricao" class="form-control" placeholder="Descri√ß√£o da sa√≠da">
        </div>
      </div>

      <div class="row g-3 mt-2">
        <div class="col-md-3">
          <label class="form-label fw-bold">Valor (R$):</label>
          <input type="text" id="valor" class="form-control" placeholder="R$ 0,00">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-bold">Data:</label>
          <input type="date" id="data" class="form-control">
        </div>
        <div class="col-md-3">
          <label class="form-label fw-bold">Recorrente:</label>
          <select id="recorrente" class="form-select">
            <option>N√£o</option>
            <option>Sim</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label fw-bold">Status:</label>
          <select id="pago" class="form-select">
            <option>Sim</option>
            <option>N√£o</option>
          </select>
        </div>
      </div>

      <div class="mt-3">
        <button class="btn btn-success-modern btn-modern" onclick="adicionarSaida()">
          <i class="fas fa-plus"></i> Adicionar Sa√≠da
        </button>
        <button class="btn btn-secondary btn-modern" onclick="fazerLogout()">
          <i class="fas fa-sign-out-alt"></i> Sair
        </button>
      </div>
    </div>

    <!-- SA√çDAS DO M√äS -->
    <div class="card-modern">
      <h5 class="mb-3">üìä Sa√≠das do M√™s Atual</h5>
      
      <div class="table-responsive">
        <table class="table table-modern">
          <thead>
            <tr>
              <th>Usu√°rio</th>
              <th>Loja</th>
              <th>Centro de Custo</th>
              <th>Descri√ß√£o</th>
              <th>Valor</th>
              <th>Data</th>
              <th>Recorrente</th>
              <th>Status</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="tabelaSaidas">
            <!-- Sa√≠das ser√£o inseridas aqui -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- LOADING -->
    <div id="loading" class="loading">
      <div class="spinner"></div>
      <p>Carregando dados...</p>
    </div>
  </div>

  <script>
    // Vari√°veis globais
    let usuarioAtual = null;
    let saidas = [];

    // Credenciais de login
    const usuarios = {
      'admin': 'admin123',
      'user1': 'user123',
      'user2': 'user456'
    };

    // Fun√ß√£o de notifica√ß√£o
    function mostrarNotificacaoInteligente(mensagem, tipo = 'success') {
      const notificacao = document.getElementById('notificacaoInteligente');
      const texto = document.getElementById('textoNotificacao');
      
      if (!notificacao || !texto) return;
      
      texto.textContent = mensagem;
      
      // Remove classes anteriores
      notificacao.classList.remove('error', 'warning');
      
      // Adiciona classe do tipo
      if (tipo === 'error') {
        notificacao.classList.add('error');
      } else if (tipo === 'warning') {
        notificacao.classList.add('warning');
      }
      
      // Mostra notifica√ß√£o
      notificacao.classList.add('show');
      
      // Auto-ocultar ap√≥s 3 segundos
      setTimeout(() => {
        notificacao.classList.remove('show');
      }, 3000);
    }

    // Fun√ß√£o de login
    function fazerLogin(event) {
      if (event) {
        event.preventDefault();
        event.stopPropagation();
      }
      
      const usuario = document.getElementById('loginUsuario').value.trim();
      const senha = document.getElementById('loginSenha').value.trim();
      const errorDiv = document.getElementById('loginError');
      const errorText = document.getElementById('loginErrorText');
      
      console.log('Tentativa de login:', usuario, senha); // Debug
      
      if (!usuario || !senha) {
        if (errorDiv && errorText) {
          errorText.textContent = 'Por favor, preencha todos os campos!';
          errorDiv.style.display = 'block';
          setTimeout(() => errorDiv.style.display = 'none', 3000);
        }
        return false;
      }
      
      // Verifica credenciais
      if (usuarios[usuario] && usuarios[usuario] === senha) {
        console.log('Login bem-sucedido!'); // Debug
        
        usuarioAtual = usuario;
        
        // Salva no localStorage
        try {
          localStorage.setItem('usuarioLogado', usuario);
        } catch (e) {
          console.warn('LocalStorage n√£o dispon√≠vel');
        }
        
        // Esconde login e mostra painel
        const loginContainer = document.getElementById('loginContainer');
        const mainContainer = document.getElementById('mainContainer');
        
        if (loginContainer) {
          loginContainer.style.transition = 'opacity 0.5s ease';
          loginContainer.style.opacity = '0';
          setTimeout(() => {
            loginContainer.style.display = 'none';
          }, 500);
        }
        
        if (mainContainer) {
          mainContainer.style.display = 'block';
          setTimeout(() => {
            mainContainer.classList.add('show');
          }, 100);
        }
        
        mostrarNotificacaoInteligente(`‚úÖ Bem-vindo, ${usuario}!`);
        inicializarSistema();
        
      } else {
        console.log('Credenciais inv√°lidas'); // Debug
        
        if (errorDiv && errorText) {
          errorText.textContent = 'Usu√°rio ou senha incorretos!';
          errorDiv.style.display = 'block';
          setTimeout(() => errorDiv.style.display = 'none', 3000);
        }
      }
      
      return false;
    }

    // Fun√ß√£o de logout
    function fazerLogout() {
      try {
        localStorage.removeItem('usuarioLogado');
      } catch (e) {
        console.warn('LocalStorage n√£o dispon√≠vel');
      }
      
      usuarioAtual = null;
      
      const loginContainer = document.getElementById('loginContainer');
      const mainContainer = document.getElementById('mainContainer');
      
      if (loginContainer) {
        loginContainer.style.display = 'flex';
        loginContainer.style.opacity = '1';
      }
      
      if (mainContainer) {
        mainContainer.classList.remove('show');
        setTimeout(() => mainContainer.style.display = 'none', 300);
      }
      
      // Limpa formul√°rio
      document.getElementById('loginUsuario').value = '';
      document.getElementById('loginSenha').value = '';
      
      mostrarNotificacaoInteligente('üëã Logout realizado com sucesso!');
    }

    // Verifica sess√£o existente
    function verificarSessao() {
      try {
        const usuarioSalvo = localStorage.getItem('usuarioLogado');
        if (usuarioSalvo && usuarios[usuarioSalvo]) {
          usuarioAtual = usuarioSalvo;
          
          const loginContainer = document.getElementById('loginContainer');
          const mainContainer = document.getElementById('mainContainer');
          
          if (loginContainer) loginContainer.style.display = 'none';
          if (mainContainer) {
            mainContainer.style.display = 'block';
            mainContainer.classList.add('show');
          }
          
          inicializarSistema();
          return true;
        }
      } catch (e) {
        console.warn('Erro ao verificar sess√£o:', e);
      }
      return false;
    }

    // Inicializar sistema
    function inicializarSistema() {
      console.log('Sistema inicializado para:', usuarioAtual);
      
      // Define data atual
      const hoje = new Date().toISOString().split('T')[0];
      const campoData = document.getElementById('data');
      if (campoData) {
        campoData.value = hoje;
      }
      
      // Carrega dados salvos
      carregarDados();
      atualizarDashboard();
      atualizarTabela();
    }

    // Adicionar sa√≠da
    function adicionarSaida() {
      const loja = document.getElementById('loja').value;
      const categoria = document.getElementById('categoria').value;
      const descricao = document.getElementById('descricao').value;
      const valor = document.getElementById('valor').value;
      const data = document.getElementById('data').value;
      const recorrente = document.getElementById('recorrente').value;
      const pago = document.getElementById('pago').value;
      
      if (!descricao || !valor || !data) {
        mostrarNotificacaoInteligente('Preencha todos os campos obrigat√≥rios!', 'error');
        return;
      }
      
      const novaSaida = {
        id: Date.now(),
        usuario: usuarioAtual,
        loja,
        categoria,
        descricao,
        valor: parseFloat(valor.replace(/[^\d,]/g, '').replace(',', '.')) || 0,
        data,
        recorrente,
        pago,
        timestamp: new Date().toISOString()
      };
      
      saidas.push(novaSaida);
      salvarDados();
      
      // Limpa formul√°rio
      document.getElementById('descricao').value = '';
      document.getElementById('valor').value = '';
      
      mostrarNotificacaoInteligente('‚úÖ Sa√≠da adicionada com sucesso!');
      atualizarDashboard();
      atualizarTabela();
    }

    // Atualizar dashboard
    function atualizarDashboard() {
      const mesAtual = new Date().getMonth() + 1;
      const anoAtual = new Date().getFullYear();
      
      const saidasMes = saidas.filter(s => {
        const dataSaida = new Date(s.data);
        return dataSaida.getMonth() + 1 === mesAtual && dataSaida.getFullYear() === anoAtual;
      });
      
      const totalMes = saidasMes.reduce((sum, s) => sum + s.valor, 0);
      const totalRecorrente = saidasMes.filter(s => s.recorrente === 'Sim').reduce((sum, s) => sum + s.valor, 0);
      const maiorGasto = Math.max(...saidasMes.map(s => s.valor), 0);
      
      // Categoria mais frequente
      const categorias = {};
      saidasMes.forEach(s => {
        categorias[s.categoria] = (categorias[s.categoria] || 0) + 1;
      });
      const categoriaTopo = Object.keys(categorias).length > 0 ? 
        Object.keys(categorias).reduce((a, b) => categorias[a] > categorias[b] ? a : b) : '-';
      
      // Atualiza elementos
      const elementos = {
        totalMes: `R$ ${totalMes.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`,
        totalRecorrente: `R$ ${totalRecorrente.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`,
        maiorGasto: `R$ ${maiorGasto.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`,
        categoriaTopo: categoriaTopo,
        totalSaidas: saidas.length
      };
      
      Object.keys(elementos).forEach(id => {
        const elemento = document.getElementById(id);
        if (elemento) {
          elemento.textContent = elementos[id];
        }
      });
    }

    // Atualizar tabela
    function atualizarTabela() {
      const tbody = document.getElementById('tabelaSaidas');
      if (!tbody) return;
      
      tbody.innerHTML = '';
      
      if (saidas.length === 0) {
        tbody.innerHTML = '<tr><td colspan="9" class="text-center">Nenhuma sa√≠da cadastrada</td></tr>';
        return;
      }
      
      // Ordena por data (mais recente primeiro)
      const saidasOrdenadas = [...saidas].sort((a, b) => new Date(b.data) - new Date(a.data));
      
      saidasOrdenadas.forEach(saida => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${saida.usuario}</td>
          <td>${saida.loja}</td>
          <td>${saida.categoria}</td>
          <td>${saida.descricao}</td>
          <td>R$ ${saida.valor.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</td>
          <td>${new Date(saida.data).toLocaleDateString('pt-BR')}</td>
          <td><span class="badge ${saida.recorrente === 'Sim' ? 'bg-success' : 'bg-secondary'}">${saida.recorrente}</span></td>
          <td><span class="badge ${saida.pago === 'Sim' ? 'bg-success' : 'bg-warning'}">${saida.pago}</span></td>
          <td>
            <button class="btn btn-danger btn-sm" onclick="excluirSaida(${saida.id})">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    // Excluir sa√≠da
    function excluirSaida(id) {
      if (confirm('Tem certeza que deseja excluir esta sa√≠da?')) {
        saidas = saidas.filter(s => s.id !== id);
        salvarDados();
        mostrarNotificacaoInteligente('üóëÔ∏è Sa√≠da exclu√≠da com sucesso!');
        atualizarDashboard();
        atualizarTabela();
      }
    }

    // Salvar dados
    function salvarDados() {
      try {
        localStorage.setItem('saidasIClub', JSON.stringify(saidas));
      } catch (e) {
        console.warn('Erro ao salvar dados:', e);
      }
    }

    // Carregar dados
    function carregarDados() {
      try {
        const dados = localStorage.getItem('saidasIClub');
        if (dados) {
          saidas = JSON.parse(dados);
        }
      } catch (e) {
        console.warn('Erro ao carregar dados:', e);
        saidas = [];
      }
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM carregado');
      
      // Configura o formul√°rio de login
      const loginForm = document.getElementById('loginForm');
      if (loginForm) {
        loginForm.addEventListener('submit', fazerLogin);
      }
      
      // Verifica se j√° tem sess√£o ativa
      if (!verificarSessao()) {
        // Se n√£o tem sess√£o, mostra o login
        const loginContainer = document.getElementById('loginContainer');
        if (loginContainer) {
          loginContainer.style.display = 'flex';
        }
      }
      
      // Focus no campo de usu√°rio
      const campoUsuario = document.getElementById('loginUsuario');
      if (campoUsuario) {
        campoUsuario.focus();
      }
    });

    // Tecla Enter no login
    document.addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && document.getElementById('loginContainer').style.display !== 'none') {
        fazerLogin(e);
      }
    });

    // Formata√ß√£o de moeda
    document.getElementById('valor')?.addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      value = (value/100).toLocaleString('pt-BR', {
        style: 'currency',
        currency: 'BRL'
      });
      e.target.value = value;
    });
  </script>
</body>
</html>